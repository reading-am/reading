/*
 MIT License (c) copyright B Cavalier & J Hann */

window.reading||(window.reading={});var require=curl;require({apiContext:window.reading,defineContext:window.reading,baseUrl:"//0.0.0.0:3000/assets",packages:{app:{path:"backbone",main:"reading"},extend:{path:"libs/extend"},plugins:{path:"jquery"}},paths:{jquery:"libs/jquery",jquery_ui:"libs/jquery_ui",underscore:"libs/lodash_extended",backbone:"libs/backbone_extended",handlebars:"libs/handlebars_extended"}});var s=!0,B=!1;(function(e){function t(){}function n(e,t){return 0==S.call(e).indexOf("[object "+t)}function r(e){return e&&"/"==e.charAt(e.length-1)?e.substr(0,e.length-1):e}function i(e,t){var n,r,i;return r=1,e=e.replace(O,function(e,t,n,o){return n&&r++,i=s,o||""}),i?(n=t.split("/"),n.splice(n.length-r,r),n.concat(e||[]).join("/")):e}function o(e){var t=e.indexOf("!");return{J:e.substr(t+1),k:0<=t&&e.substr(0,t)}}function u(){}function a(e){return u.prototype=e,e=new u,u.prototype=E,e}function f(){function e(e,t,n){i.push([e,t,n])}function n(e,t){for(var n,r=0;n=i[r++];)(n=n[e])&&n(t)}var r,i,o;r=this,i=[],o=function(r,s){e=r?function(e){e&&e(s)}:function(e,t){t&&t(s)},o=t,n(r?0:1,s),n=t,i=x},this.Z=function(t,n,r){e(t,n,r)},this.h=function(e){r.ga=e,o(s,e)},this.c=function(e){r.fa=e,o(B,e)},this.p=function(e){n(2,e)}}function l(e,t,n,r){e instanceof f?e.Z(t,n,r):t(e)}function c(e,t,n){var r;return function(){return 0<=--e&&t&&(r=t.apply(x,arguments)),0==e&&n&&n(r),r}}function h(){function e(t,n,r){var i;i=P.f(d,x,[].concat(t)),this.then=t=function(e,t){return l(i,function(t){e&&e.apply(x,t)},function(e){if(!t)throw e;t(e)}),this},this.next=function(t,n){return new e(t,n,i)},n&&t(n),l(r,function(){P.j(i)})}var t=[].slice.call(arguments);return n(t[0],"Object")&&(d=P.C(t.shift()),P.t(d)),new e(t[0],t[1])}function p(e){var t=e.id;t==x&&(k!==x?k={A:"Multiple anonymous defines in url"}:(t=P.U())||(k=e));if(t!=x){var n=N[t];t in N||(n=P.l(t,d).e,n=N[t]=P.v(n,t)),n instanceof f&&(n.aa=B,P.w(n,e))}}var d=e.reading.curl,v=e.document,m=v&&(v.head||v.getElementsByTagName("head")[0]),g={},y={},b={},w={},E={},S=E.toString,x,T={loaded:1,interactive:b,complete:1},N={},C=B,k,L=/\?/,A=/^\/|^[^:]+:\/\//,O=/(\.)(\.?)(?:$|\/([^\.\/]+.*)?)/g,M=/\/\*[\s\S]*?\*\/|(?:[^\\])\/\/.*?[\n\r]/g,_=/require\s*\(\s*["']([^"']+)["']\s*\)|(?:[^\\]?)(["'])/g,D,P;P={f:function(e,t,r,s){function o(e){return i(e,a.d)}function u(t,r){var i,u,c,h;i=r&&function(e){r.apply(x,e)};if(n(t,"String")){u=o(t),c=N[u],h=c instanceof f&&c.a;if(u in N){if(i)throw Error("require(id, callback) not allowed");return h||c}throw Error("Module not resolved: "+u)}l(P.j(P.f(e,a.d,t,s)),i)}var a;return a=new f,a.d=a.id=t||"",a.V=s,a.z=r,a.q=u,u.toUrl=function(t){return P.l(o(t),e).url},a.$=o,a},v:function(e,t,n,r){var i,s,o;return i=P.f(e,t,x,n),i.d=r==x?t:r,s=i.h,o=c(1,function(e){i.n=e;try{return P.N(i)}catch(t){i.c(t)}}),i.h=function(e){l(n||C,function(){s(N[i.id]=o(e))})},i.B=function(e){l(n||C,function(){i.a&&(o(e),i.p(y))})},i},L:function(e,t,n,r){return e=P.f(e,t,x,n),e.d=r,e},T:function(e){return e.q},D:function(e){return e.a||(e.a={})},S:function(e){var t=e.o;return t||(t=e.o={id:e.id,uri:P.F(e),exports:P.D(e)},t.a=t.exports),t},F:function(e){return e.url||(e.url=P.u(e.q.toUrl(e.id)))},C:function(e){function t(t,n){var s,f,l,c,h;for(h in t){l=t[h],l.name=l.id||l.name||h,c=e,f=o(r(l.name||h)),s=f.J;if(f=f.k)c=u[f],c||(c=u[f]=a(e),c.g=a(e.g),c.b=[]),delete t[h];if(n){f=l;var p=void 0;f.path=r(f.path||f.location||""),p=r(f.main)||"main","."!=p.charAt(0)&&(p="./"+p),f.G=i(p,f.name+"/"),f.X=i(p,f.path+"/"),f.e=f.config}else f={path:r(l)};f.K=s.split("/").length,s?(c.g[s]=f,c.b.push(s)):c.s=P.I(l,e)}}function n(e){var t=e.g;e.Y=RegExp("^("+e.b.sort(function(e,n){return t[e].K<t[n].K}).join("|").replace(/\/|\./g,"\\$&")+")(?=\\/|$)"),delete e.b}var u;e.s=e.baseUrl||"",e.H="pluginPath"in e?e.pluginPath:"curl/plugin",e.g={},u=e.plugins=e.plugins||{},e.b=[],t(e.paths,B),t(e.packages,s);for(var f in u){var l=u[f].b;l&&(u[f].b=l.concat(e.b),n(u[f]))}return n(e),e},t:function(e){var t;(t=e.preloads)&&0<t.length&&l(C,function(){C=P.j(P.f(e,x,t,s))})},l:function(e,t,n){var i,s,o,u;return i=t.g,n&&t.H&&0>e.indexOf("/")&&!(e in i)&&(o=e=r(t.H)+"/"+e),n=A.test(e)?e:e.replace(t.Y,function(t){return s=i[t]||{},u=s.e,s.G&&t==e?(o=s.G,s.X):s.path||""}),{d:o||e,e:u||d,url:P.I(n,t)}},I:function(e,t){var n=t.s;return n&&!A.test(e)?r(n)+"/"+e:e},u:function(e){return e+(L.test(e)?"":".js")},W:function(t,n,r){var i=v.createElement("script");return i.onload=i.onreadystatechange=function(r){r=r||e.event;if("load"==r.type||T[i.readyState])delete w[t.id],i.onload=i.onreadystatechange=i.onerror="",n()},i.onerror=function(){r(Error("Syntax or http error: "+t.url))},i.type=t.da||"text/javascript",i.charset="utf-8",i.async=!t.ea,i.src=t.url,w[t.id]=i,m.insertBefore(i,m.firstChild),i},O:function(e){var t=[],n;return("string"==typeof e?e:e.toSource?e.toSource():e.toString()).replace(M,"").replace(_,function(e,r,i){return i?n=n==i?x:n:n||t.push(r),e}),t},R:function(e){var t,r,i,o,u,a;return u=e.length,i=e[u-1],o=n(i,"Function")?i.length:-1,2==u?n(e[0],"Array")?r=e[0]:t=e[0]:3==u&&(t=e[0],r=e[1]),!r&&0<o&&(a=s,r=["require","exports","module"].slice(0,o).concat(P.O(i))),{id:t,n:r||[],r:0<=o?i:function(){return i},m:a}},N:function(e){var t;return t=e.r.apply(e.m?e.a:x,e.n),t===x&&e.a&&(t=e.o?e.a=e.o.a:e.a),t},w:function(e,t){e.r=t.r,e.m=t.m,e.z=t.n,P.j(e)},j:function(e){function t(e,t,n){u[t]=e,n&&p(e,t)}function n(t,n){var r,i,s,o;r=c(1,function(e){i(e),d(e,n)}),i=c(1,function(e){p(e,n)}),s=P.P(t,e),(o=s instanceof f&&s.a)&&i(o),l(s,r,e.c,e.a&&function(e){s.a&&(e==g?i(s.a):e==y&&r(s.a))})}function r(){e.h(u)}var i,o,u,a,h,p,d;u=[],o=e.z,a=o.length,0==o.length&&r(),p=c(a,t,function(){e.B&&e.B(u)}),d=c(a,t,r);for(i=0;i<a;i++)h=o[i],h in D?(d(D[h](e),i,s),e.a&&e.p(g)):h?n(h,i):d(x,i,s);return e},Q:function(e){return P.F(e),P.W(e,function(){var t=k;k=x,e.aa!==B&&(!t||t.A?e.c(Error(t&&t.A||"define() missing or duplicated: "+e.url)):P.w(e,t))},e.c),e},P:function(e,t){var n,r,i,s,u,a,c,h,p;n=t.$,r=t.V,i=o(e),a=i.J,s=n(i.k||a),c=P.l(s,d,!!i.k);if(i.k)u=s;else if(u=c.e.moduleLoader)a=s,s=u,c=P.l(u,d);return i=N[s],s in N||(i=N[s]=P.v(c.e,s,r,c.d),i.url=P.u(c.url),P.Q(i)),s==u&&(h=new f,p=d.plugins[u]||d,l(i,function(e){var t,i,s;s=e.dynamic,a="normalize"in e?e.normalize(a,n,p)||"":n(a),i=u+"!"+a,t=N[i];if(!(i in N)){t=P.L(p,i,r,a),s||(N[i]=t);var o=function(e){t.h(e),s||(N[i]=e)};o.resolve=o,o.reject=t.c,e.load(a,t.q,o,p)}h!=t&&l(t,h.h,h.c,h.p)},h.c)),h||i},U:function(){var t;if(!n(e.opera,"Opera"))for(var r in w)if(T[w[r].readyState]==b){t=r;break}return t}},D={require:P.T,exports:P.D,module:P.S};if(!n(d,"Function")){d=P.C(d||{}),P.t(d);var H,j,F,I;H=d.apiName||"curl",F=d.defineName||"define",j=d.apiContext||e,I=d.defineContext||e,j[H]=h,I[F]=H=function(){var e=P.R(arguments);p(e)},N.curl=h,h.version="0.6.3",H.amd={plugins:s,jQuery:s,curl:"0.6.3"},N["curl/_privileged"]={core:P,cache:N,cfg:d,_define:p,_curl:h,Promise:f}}})(this),function(e){function t(e,t){var n=e.link;n[h]=n[p]=function(){if(!n.readyState||"complete"==n.readyState)y["event-link-onload"]=s,a(e),t()}}function n(e){for(var e=e.split("!"),t,n=1;t=e[n++];)t=t.split("=",2),e[t[0]]=2==t.length?t[1]:s;return e}function r(e){if(document.createStyleSheet&&(x||(x=document.createStyleSheet()),30<=document.styleSheets.length)){var t,n,r,i=0;r=x,x=null;for(n=document.getElementsByTagName("link");t=n[i];)t.getAttribute("_curl_movable")?(r.addImport(t.href),t.parentNode&&t.parentNode.removeChild(t)):i++}return e=e[d]("link"),e.rel="stylesheet",e.type="text/css",e.setAttribute("_curl_movable",s),e}function i(e){var t,n,r=B;try{if(t=e.sheet||e.styleSheet,(r=(n=t.cssRules||t.rules)?0<n.length:n!==m)&&"[object Chrome]"=={}.toString.call(window.ca))t.insertRule("#_cssx_load_test{margin-top:-5px;}",0),T||(T=E[d]("div"),T.id="_cssx_load_test",S.appendChild(T)),r="-5px"==E.defaultView.getComputedStyle(T,null).marginTop,t.deleteRule(0)}catch(i){r=1e3==i.code||i.message.match(/security|denied/i)}return r}function o(e,t){i(e.link)?(a(e),t()):v||setTimeout(function(){o(e,t)},e.ba)}function u(e,n){function r(){i||(i=s,n())}var i;t(e,r),y["event-link-onload"]||o(e,r)}function a(e){e=e.link,e[h]=e[p]=null}function f(e,t){return e.replace(w,function(e,n){var r=n;return b.test(r)||(r=t+r),'url("'+r+'")'})}function l(e){return clearTimeout(l.M),l.i?l.i.push(e):(l.i=[e],N=E.createStyleSheet?E.createStyleSheet():S.appendChild(E.createElement("style"))),l.M=setTimeout(function(){var e,t;e=N,N=m,t=l.i.join("\n"),l.i=m,t=t.replace(/.+charset[^;]+;/g,""),"cssText"in e?e.cssText=t:e.appendChild(E.createTextNode(t))},0),N}function c(e){return{cssRules:function(){return e.cssRules||e.rules},insertRule:e.insertRule||function(t,n){var r=t.split(/\{|\}/g);return e.addRule(r[0],r[1],n),n},deleteRule:e.deleteRule||function(t){return e.removeRule(t),t},sheet:function(){return e}}}var h="onreadystatechange",p="onload",d="createElement",v=B,m,g={},y={},b=/^\/|^[^:]*:\/\//,w=/url\s*\(['"]?([^'"\)]*)['"]?\)/g,E=e.document,S;E&&(S=E.head||(E.head=E.getElementsByTagName("head")[0]));var x,T,N;reading.define("css",{normalize:function(e,t){var n,r;if(!e)return e;n=e.split(","),r=[];for(var i=0,s=n.length;i<s;i++)r.push(t(n[i]));return r.join(",")},load:function(e,t,i,o){function a(){--p==0&&setTimeout(function(){i(c(y.sheet||y.styleSheet))},0)}var h=(e||"").split(","),p=h.length;if(e)for(var d=h.length-1,v;d>=0;d--,v=s){var e=h[d],e=n(e),m=e.shift(),m=t.toUrl(m.lastIndexOf(".")<=m.lastIndexOf("/")?m+".css":m),y=r(E),b={link:y,url:m,ba:o.cssWatchPeriod||50};("nowait"in e?e.nowait!="false":o.cssDeferLoad)?i(c(y.sheet||y.styleSheet)):u(b,a),y.href=m,v?S.insertBefore(y,g[v].previousSibling):S.appendChild(y),g[m]=y}else i({translateUrls:function(e,n){var r;return r=t.toUrl(n),r=r.substr(0,r.lastIndexOf("/")+1),f(e,r)},injectStyle:function(e){return l(e)},proxySheet:function(e){return e.sheet&&(e=e.sheet),c(e)}})},"plugin-builder":"./builder/css"})}(this),reading.curl(["jquery","libs/base58","libs/indian","app","app/models/post","models/current_user","plugins/rails","plugins/cookies","components/titlecard","views/settings","views/post","views/user","views/hooks/init"],function(e,t,n,r,i,s){var o;window.current_user=s,e.cookie("timezone")||(o=new Date,e.cookie("timezone",o.getTimezoneOffset(),{path:"/",expires:10})),window.hasfocus=!0,e(window).focus(function(){return window.hasfocus=!0}).blur(function(){return window.hasfocus=!1}),e(function(){var n,o,u;return u=window.top!==window,u&&e("body").addClass("framed"),e("a.external").on("click",function(){var n,r,o,a,f,l;n=e(this),a=this.href.split("/")[2],o=document.location.href.split("/")[2],r=typeof n.data("base58-id")!="undefined"?n.data("base58-id"):"";if(a!==o)return u?(l="//"+o+"/"+(r?"p/"+r+"/":""),window.top.location=l+this.href):(s.logged_in()&&(f=new i({url:this.href,referrer_id:r?t.decode(r):""}),f.save()),window.open(this.href)),!1}),e(".footnote").on("click",function(){return window.open(e(this).data("url"),"footnote","location=0,status=0,scrollbars=0,width=900,height=400"),!1}),n=e("#search input"),n.val()&&n.focus(),o=function(t,n){var i,s,o=this;return s=n==="connect"?"new":null,i=new r.Models[""+t+"Auth"](s),e("#loading").fadeIn(),i.login({success:function(e){return window.location.reload(!0)},error:function(n){var r;return e("#loading").hide(),alert(((r=Constants.errors[n.status])!=null?r:Constants.errors.generic).replace(/{provider}/gi,t))}}),!1},e("a[data-provider][data-method]").on("click",function(){var t;return t=e(this),o(t.data("provider"),t.data("method"))}),e("#authorizations select").on("change",function(){var t;return t=e(this),o(t.val(),t.data("method")),t.val(t.find("option:first").val())}),e(".chrome-install").on("click",function(){if(/chrome/.test(navigator.userAgent.toLowerCase()))return chrome.webstore.install(),!1}),e(".firefox-install").on("click",function(){return window.open(e(this).attr("href")),!1})});if(n.is)return window.document.title="âœŒ Reading",e(window).focus(function(){return n.badge(""),e(".post.new").fadeTo("medium",1).removeClass("new")})}),define("application",function(){})