<% if !params[:username] && !current_user.username %>
  <%= render :partial => 'users/username_form', :locals => { :user => current_user } %>
<% end %>

<% bookmarklet = "javascript:(function(){var otherlib=(typeof jQuery=='undefined'&&typeof $=='function');function getScript(url,success){var script=document.createElement('script');script.src=url;var head=document.getElementsByTagName('head')[0],done=false;script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=='loaded'||this.readyState=='complete')){done=true;success();script.onload=script.onreadystatechange=null;head.removeChild(script);}};head.appendChild(script);}getScript('http://code.jquery.com/jquery-latest.min.js',function(){if(typeof jQuery=='undefined'){alert('There was an error loading jquery');}else{jQuery.getScript('http://0.0.0.0:3000/javascripts/reading.js');}});})();" %>
<%= link_to 'Your Bookmarklet', bookmarklet %>

<h1>Listing posts</h1>

<table>
  <tr>
    <th>User</th>
    <th>Page</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @posts.each do |post| %>
  <tr>
    <td><%= post.user.username %></td>
    <td><%= link_to post.title, post.url %></td>
    <td><%= link_to 'Show', post %></td>
    <td><%= link_to 'Edit', edit_post_path(post) %></td>
    <td><%= link_to 'Destroy', post, :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New Post', new_post_path %>
